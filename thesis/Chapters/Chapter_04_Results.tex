\chapter{Results}\label{ch:results}

\begin{figure}[H]
\input{Chapters/Chapter_02_Technical_Concepts/tikz/df_block_pyrates}
\caption{\textbf{David \& Friston Block Diagram as implemented in PyRates:}}
\label{fig:pyratesDFBlock}
\end{figure}

\section{General features of the simulated data}\label{sec:general-features-of-the-simulated-data}

The NMM is configured to simulate data with a step-size of $1 ms$, yielding a $1000 Hz$ signal.
In its initial state, the system reacts with high-amplitude oscillations to the "disturbance" of the random input.
However, the signal usually stabilizes quickly and exhibits the expected behaviour.
Thus, the first few seconds (stabilization-time varies with parameterization) of simulated data
are always discarded before further analysis.
When generating data continuously (without re-initialization of the state-variables),
this problem only occurs once in the very beginning.
Changing system parameters abruptly during simulation can also result in disturbances and destabilize the
signal.

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \pgfplotsset{
        %% Axis
            scale only axis,
            width=0.4\linewidth,
            height=4cm,
            every axis/.append style={
                line width=1pt,
                tick style={line width=0.8pt},
                %   grid style={dashed, black!20},
                %  grid=major,
            },
%               %% X-Axis
            xmin=-0.1,
            xmax=7,
        }
        \begin{groupplot} [
                group style={
                    group size=2 by 2,
                    vertical sep=12mm,
                    horizontal sep=12mm,
                },
                yticklabel style={
                    /pgf/number format/fixed,
                    /pgf/number format/precision=2
                },
                legend style={nodes={scale=0.8, transform shape}, thin},
                legend image post style={scale=0},
            ]
            \nextgroupplot[ylabel=$mV$, xlabel=$s$]
            \addplot [line width=.5pt,solid, cyan]
            table[x=x,y=y ,col sep=comma]{data/methodology/uncut.csv};
            \legend{\textbf{A)} uncut data};

            \nextgroupplot[xmin=3.0, xlabel=$s$]
            \addplot [line width=.5pt,solid, cyan]
            table[x=x,y=y ,col sep=comma]{data/methodology/uncut.csv};
            \legend{\textbf{B)} cut data};

            \nextgroupplot[xmax=30.0, ylabel=$dB$, xlabel=$Hz$]
            \addplot [line width=.5pt,solid, cyan]
            table[x=x,y=y ,col sep=comma]{data/methodology/psd_welch_jr.csv};
            \legend{\textbf{C)} J-R PSD};

            \nextgroupplot[xmax=30.0, xlabel=$Hz$]
            \addplot [line width=.5pt,solid, cyan]
            table[x=x,y=y ,col sep=comma]{data/methodology/psd_welch_df.csv};
            \legend{\textbf{D)} D\&F PSD};

        \end{groupplot}
    \end{tikzpicture}

    \caption{
        \textbf{Processing of simulated data.} \\
        \textbf{A) \& B):} removing initially unstable signal by cutting off the first $3s$ of the
        data (generated by Simple Jansen-Rit Model with $C=135$.). \\
        \textbf{C) \& D):} Power Spectral Density of Jansen-Rit and David \& Friston Model (Welch's Method)
    }
    \label{fig:initial_oscilations}
\end{figure}

\section{Visualization}\label{sec:visualization}

\begin{figure}[H]
\includegraphics[width=14cm]{Figures/temp_sim_results}
\caption{\textbf{Power Spectral Density of Simulation Results:} Reduction of the connectivity parameter $C$
    from $135$ to $108$ shows a tendency of reducing the strength of the frequency-bands above 12--14Hz,
    while increasing it below that value - especially around 8--12Hz.}
\label{fig:sim_results1}
\end{figure}

\todo{objective description of simulation results}